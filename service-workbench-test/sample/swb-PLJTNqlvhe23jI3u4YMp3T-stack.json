{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "This template is generated by the Service Workbench application to allow it to connect to studies owned by account \"700702834148\".IMPORTANT: ensure that you deploy this template in account \"700702834148\" and region \"us-east-2\"",
  "Resources": {
    "AppRoleStackswbPLJTNqlvhe23jI3u4YMp3T": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": "swb-PLJTNqlvhe23jI3u4YMp3T-app-role-stack",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "AWS": "375205257662"
              },
              "Action": [
                "sts:AssumeRole"
              ]
            }
          ]
        },
        "Description": "An application role that allows the SWB application to check the status of the stack",
        "Policies": [
          {
            "PolicyName": "swb-app-role-stack-essentials",
            "PolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Sid": "CfnRelated",
                  "Effect": "Allow",
                  "Action": [
                    "cloudformation:DescribeStacks",
                    "cloudformation:ListStackResources"
                  ],
                  "Resource": [
                    "arn:aws:cloudformation:us-east-2:700702834148:stack/swb-PLJTNqlvhe23jI3u4YMp3T-stack/*"
                  ]
                }
              ]
            }
          }
        ]
      }
    },
    "ManagedPolicyswbPLJTNqlvhe23jI3u4YMp3Tapp1622277849805": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "Description": "A managed policy that is used as the permission boundary for all roles that are created by SWB",
        "ManagedPolicyName": "swb-PLJTNqlvhe23jI3u4YMp3T-app-1622277849805",
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Sid": "S3StudyReadWriteAccess",
              "Effect": "Allow",
              "Action": [
                "s3:GetObject",
                "s3:GetObjectTagging",
                "s3:GetObjectTorrent",
                "s3:GetObjectVersion",
                "s3:GetObjectVersionTagging",
                "s3:GetObjectVersionTorrent",
                "s3:AbortMultipartUpload",
                "s3:ListMultipartUploadParts",
                "s3:PutObject",
                "s3:PutObjectAcl",
                "s3:PutObjectTagging",
                "s3:PutObjectVersionTagging",
                "s3:DeleteObject",
                "s3:DeleteObjectTagging",
                "s3:DeleteObjectVersion",
                "s3:DeleteObjectVersionTagging"
              ],
              "Resource": [
                "arn:aws:s3:::rwang5688-us-east-2-bucket/study-01/*",
                "arn:aws:s3:::rwang5688-us-east-2-bucket/study-03/*",
                "arn:aws:s3:::rwang5688-us-east-2-bucket/study-02/*"
              ]
            },
            {
              "Sid": "studyListS3Access1",
              "Effect": "Allow",
              "Action": [
                "s3:ListBucket",
                "s3:ListBucketVersions"
              ],
              "Resource": "arn:aws:s3:::rwang5688-us-east-2-bucket",
              "Condition": {
                "StringLike": {
                  "s3:prefix": [
                    "study-01/*",
                    "study-03/*",
                    "study-02/*"
                  ]
                }
              }
            },
            {
              "Sid": "studyKMSAccess",
              "Action": [
                "kms:Decrypt",
                "kms:DescribeKey",
                "kms:Encrypt",
                "kms:GenerateDataKey",
                "kms:ReEncrypt*"
              ],
              "Effect": "Allow",
              "Resource": [
                "arn:aws:kms:us-east-2:700702834148:key/038ab465-90c1-4456-bbbb-f45a137323b1"
              ]
            }
          ]
        }
      }
    },
    "AppRoleswbPLJTNqlvhe23jI3u4YMp3Tapp1622277849805": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": "swb-PLJTNqlvhe23jI3u4YMp3T-app-1622277849805",
        "AssumeRolePolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "AWS": "375205257662"
              },
              "Action": [
                "sts:AssumeRole"
              ]
            }
          ]
        },
        "Description": "An application role that allows the SWB application to create roles to access studies",
        "ManagedPolicyArns": [
          {
            "Ref": "ManagedPolicyswbPLJTNqlvhe23jI3u4YMp3Tapp1622277849805"
          }
        ],
        "MaxSessionDuration": 43200,
        "Policies": [
          {
            "PolicyName": "swb-app-role-essentials",
            "PolicyDocument": {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Sid": "RoleAndPolicyManagement",
                  "Effect": "Allow",
                  "Action": [
                    "iam:CreatePolicy",
                    "iam:UpdateAssumeRolePolicy",
                    "iam:AttachRolePolicy",
                    "iam:PutRolePolicy",
                    "iam:DeletePolicy",
                    "iam:DeleteRolePolicy",
                    "iam:DeleteRole",
                    "iam:GetPolicy",
                    "iam:GetRole",
                    "iam:GetRolePolicy"
                  ],
                  "Resource": [
                    "arn:aws:iam::700702834148:role/swb-PLJTNqlvhe23jI3u4YMp3T-fs-*",
                    "arn:aws:iam::700702834148:policy/swb-PLJTNqlvhe23jI3u4YMp3T-fs-*"
                  ]
                },
                {
                  "Sid": "RoleCreation",
                  "Effect": "Allow",
                  "Action": "iam:CreateRole",
                  "Resource": "arn:aws:iam::700702834148:role/swb-PLJTNqlvhe23jI3u4YMp3T-fs-*",
                  "Condition": {
                    "StringEquals": {
                      "iam:PermissionsBoundary": "arn:aws:iam::700702834148:policy/swb-PLJTNqlvhe23jI3u4YMp3T-app-1622277849805"
                    }
                  }
                }
              ]
            }
          }
        ]
      }
    }
  },
  "Outputs": {
    "swbTemplateInfo": {
      "Value": "{\"templateId\":\"abe8cef9448ab559ece8ae58c9e54bb173a81acd0358a635e808fc1bede4470e\",\"templateVer\":\"1.0\",\"at\":\"2021-06-04T06:15:32.561Z\"}"
    }
  }
}